# 25.05.09(ê¸ˆ) TIL

## ì˜¤ëŠ˜ í•œ ë‚´ìš©
__1. Unity ì…ë¬¸ í”„ë¡œì íŠ¸ ë°œì œ (íŒ€í”Œ)__

#### ğŸˆ ë§¡ì€ ë¶€ë¶„ : í”Œë ˆì´ì–´ë³„ ê³ ìœ  ëŠ¥ë ¥
  - ë¶ˆ  : 1. ë¶ˆ ì¥ì• ë¬¼ í†µê³¼
         2. (ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•œ ì˜¤ë¸Œì íŠ¸ ì–¼ìŒ)ë…¹ì´ê¸°
      - ì‚¬ìš©í•  ì˜¤ë¸Œì íŠ¸ê°€ ì–¼ë ¤ìˆëŠ” ê²½ìš° - ë¶ˆë¡œ ë…¹ì—¬ì„œ ì‚¬ìš©
  - ì–¼ìŒ :  1. ì–¼ìŒ ì¥ì• ë¬¼ í†µê³¼
             2. (ìƒí˜¸ì‘ìš© ê°€ëŠ¥í•œ ì˜¤ë¸Œì íŠ¸)ì–¼ë¦¬ê¸°
      - ì‚¬ìš©í•  ì˜¤ë¸Œì íŠ¸ë¥¼ ê³ ì •ì‹œí‚¤ê³  ì‹¶ì„ë•Œ - ì–¼ìŒìœ¼ë¡œ ì–¼ë ¤ì„œ ê³ ì •
    <br>
  - ì¥ì• ë¬¼ ì¢…ë¥˜ : ë¶ˆ(ë¶ˆë§Œ í†µê³¼), ì–¼ìŒ(ì–¼ìŒë§Œ í†µê³¼), ë…(ë‘˜ ë‹¤ í†µê³¼í•  ìˆ˜ ì—†ìŒ)
  
  <details>
  <summary>[í”Œë¡œìš°ì°¨íŠ¸]</summary>
      
    ![image](https://github.com/user-attachments/assets/179eba58-0ed6-4b67-bcd0-4be635674003)
  </details>
    
  <table>
    <thead>
      <tr>
        <th>í”Œë ˆì´ì–´</th>
        <th>ì¶©ëŒìœ„ì¹˜</th>
        <th>ê²°ê³¼ê°’</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td rowspan="4">Fire</td>
        <td>fire</td>
        <td>pass</td>
      </tr>
      <tr>
        <td>ice</td>
        <td rowspan="2">GameOver</td>
      </tr>
      <tr>
        <td>poison</td>
      </tr>
      <tr>
        <td>switch</td>
        <td>Melt</td>
      </tr>
      <tr>
        <td rowspan="4">Ice</td>
        <td>ice</td>
        <td>pass</td>
      </tr>
      <tr>
        <td>fire</td>
        <td rowspan="2">GameOver</td>
      </tr>
      <tr>
        <td>poison</td>
      </tr>
      <tr>
        <td>switch</td>
        <td>Frozen</td>
      </tr>
    </tbody>
  </table>

#### ğŸˆ ì‘ì„±í•œ ì½”ë“œ <br>
1. Ability.cs
     
      <details>
       <summary>[1. ê¸°ë³¸]</summary>
    
          using System;
          using System.Collections;
          using System.Collections.Generic;
          using System.Security.Cryptography;
          using Unity.VisualScripting;
          using UnityEngine;
          using UnityEngine.UIElements;
          
          public enum AbilityType
          {
              FIRE,
              ICE
          }
          
          public class Ability : MonoBehaviour
          {
              private void OnTriggerEnter2D(Collider2D other)
              {
                  Debug.Log("ì¶©ëŒ ì¤‘");
                  Interact(other.gameObject);
              }
          
              public AbilityType abilityType;
          
              const string fireTag = "Fire Obstacle"; //ë¶ˆ Tag (ìš©ì•”í’€)
              const string iceTag = "Ice Obstacle"; //ì–¼ìŒ Tag (ì–¼ìŒí’€)
              const string poisonTag = "Poison Obstacle"; //ë… Tag
              const string statefulTag = "Stateful Obstacle"; //í˜•íƒœë³€í™”ê°€ ìˆëŠ” ì˜¤ë¸Œì íŠ¸
          
              //public GameObject statefulObstacle;
              //Dictionary<string, Action> tagActions; Dictionaryë¥¼ ì“°ê³  ì‹¶ì—ˆëŠ”ë° ì¼ë‹¨ ì½”ë“œ ì‘ì„±ë¶€í„° í•˜ë ¤ê³  ë„˜ê¹€
          
              public void Interact(GameObject target)
              {
                  string targetTag = target.tag; //ë¶€ë”ªíŒ ìƒëŒ€ì˜ íƒœê·¸ í™•ì¸
          
                  switch (abilityType)
                  {
                      case AbilityType.FIRE: //í”Œë ˆì´ì–´ê°€ FIRE ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆë‹¤ë©´,
          
                          if (targetTag == fireTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ë¶ˆì¼ ê²½ìš°
                          {
                              Debug.Log("ë¶ˆ ìºë¦­í„°ê°€ ë¶ˆ í†µê³¼ ì¤‘");
                          }
                          else if (targetTag == iceTag || targetTag == poisonTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ì–¼ìŒì¼ ê²½ìš°
                          {
                              GameOver();
                          }
                          else if (targetTag == statefulTag)
                          {
                              var csSwitch = target.GetComponent<Switch>(); //íƒ€ê²Ÿ(ì¥ì• ë¬¼)ì— ë¶™ì–´ìˆëŠ” Switchë¥¼ ì°¾ìŒ
                              if(csSwitch != null)
                              {
                                  //ë…¹ì„
                                  if (csSwitch.isFrozen)
                                  {
                                      csSwitch.isFrozen = false;
                                  }
                                  else
                                  {
          
                                  }
                              }
                          }
                          break;
          
                      case AbilityType.ICE: //í”Œë ˆì´ì–´ê°€ ICE ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆë‹¤ë©´,
          
                          if (targetTag == iceTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ì–¼ìŒì¼ ê²½ìš°
                          {
                              Debug.Log("ë¬¼ ìºë¦­í„°ê°€ ì–¼ìŒ í†µê³¼ ì¤‘");
                          }
                          else if (targetTag == fireTag || targetTag == poisonTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ë¶ˆì¼ ê²½ìš°
                          {
                              GameOver();
                          }
                          else if (targetTag == statefulTag)
                          {
                              var csSwitch = target.GetComponent<Switch>();
                              if(csSwitch != null)
                              {
                                  //ì–¼ë¦¼
                                  if(!csSwitch.isFrozen)
                                  {
                                      csSwitch.isFrozen = true;
                                  }
                                  else
                                  {
          
                                  }
                              }
                          }
                          break;
                  }
              }
          
              void GameOver()
              {
                  Debug.Log("ê²Œì„ ì˜¤ë²„!");
              }
          }
      </details>
  
      <details>
       <summary>[2. ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©]</summary>

          using System;
          using System.Collections;
          using System.Collections.Generic;
          using System.Security.Cryptography;
          using Unity.VisualScripting;
          using UnityEngine;
          using UnityEngine.UIElements;
          
          
          public interface IAbility
          {
              void Interact(GameObject target);
          }
          
          public class Ability : MonoBehaviour
          {
          /*    private void OnCollisionEnter2D(Collision2D other)
              {
                  Debug.Log("ì¶©ëŒ ì¤‘");
                  Interact(other.gameObject);
              }*/
          
              public ABILITYTYPE abilityType;
          
              const string fireTag = "Fire Obstacle"; //ë¶ˆ Tag (ìš©ì•”í’€)
              const string iceTag = "Ice Obstacle"; //ì–¼ìŒ Tag (ì–¼ìŒí’€)
              const string poisonTag = "Poison Obstacle"; //ë… Tag
              const string statefulTag = "Stateful Obstacle"; //í˜•íƒœë³€í™”ê°€ ìˆëŠ” ì˜¤ë¸Œì íŠ¸
          
              //public GameObject statefulObstacle;
              //Dictionary<string, Action> tagActions;
          
              public void Interact(GameObject target)
              {
                  string targetTag = target.tag; //ë¶€ë”ªíŒ ìƒëŒ€ì˜ íƒœê·¸ í™•ì¸
                  switch (abilityType)
                  {
                      case ABILITYTYPE.FIRE: //í”Œë ˆì´ì–´ê°€ FIRE ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆë‹¤ë©´,
          
                          if (targetTag == fireTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ë¶ˆì¼ ê²½ìš°
                          {
                              Debug.Log("ë¶ˆ ìºë¦­í„°ê°€ ë¶ˆ í†µê³¼ ì¤‘");
                          }
                          else if (targetTag == iceTag || targetTag == poisonTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ì–¼ìŒì¼ ê²½ìš°
                          {
                              GameOver();
                          }
                          else if (targetTag == statefulTag)
                          {
                              if (target.TryGetComponent<Switch>(out var data)) //íƒ€ê²Ÿ(ì¥ì• ë¬¼)ì— ë¶™ì–´ìˆëŠ” Switchë¥¼ ì°¾ìŒ
                              {
                                  data.SetFrozen(abilityType == ABILITYTYPE.ICE); //SetFrozen(false)
                              }
                          }
                          break;
          
                      case ABILITYTYPE.ICE: //í”Œë ˆì´ì–´ê°€ ICE ëŠ¥ë ¥ì„ ê°€ì§€ê³  ìˆë‹¤ë©´,
          
                          if (targetTag == iceTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ì–¼ìŒì¼ ê²½ìš°
                          {
                              Debug.Log("ë¬¼ ìºë¦­í„°ê°€ ì–¼ìŒ í†µê³¼ ì¤‘");
                          }
                          else if (targetTag == fireTag || targetTag == poisonTag) //ì¥ì• ë¬¼ì˜ íƒœê·¸ê°€ ë¶ˆì¼ ê²½ìš°
                          {
                              GameOver();
                          }
                          else if (targetTag == statefulTag)
                          {
                              if (target.TryGetComponent<Switch>(out var data))
                              {
                                  data.SetFrozen(abilityType == ABILITYTYPE.ICE); //SetFrozen(true)
                              }
                          }
                          break;
                  }
              }
          
              void GameOver()
                  Debug.Log("ê²Œì„ ì˜¤ë²„!");
              }
          }
      </details>


2. Switch.cs
      <details>
       <summary>[1. ê¸°ë³¸]</summary>
          
          using Unity.VisualScripting;
          using UnityEngine;
          
          public class Switch : MonoBehaviour
          {
              [SerializeField] private GameObject ObstacleObj;
              [SerializeField] private Animator animator;
              //[SerializeField] private GameObject IceState; //ìì‹ ì˜¤ë¸Œì íŠ¸ Ice
          
              //boolê°’ì„ ì´ìš©í•´ ì–¼ìŒì´ ìˆëŠ” ì§€ ì—†ëŠ” ì§€ íŒë‹¨
              private bool isFrozen; //ì–¼ìŒ ìœ ë¬´ íŒë‹¨
              private bool isState; //ìƒí˜¸ì‘ìš©ì´ ê°€ëŠ¥í•œ ìƒíƒœì¸ì§€ í™•ì¸
              private bool isCollision; //ì¶©ëŒ ì—¬ë¶€ íŒë‹¨
          
          /*    private void Update()
              {
                  Debug.Log("isState : " + isState);
              }*/
          
              private void OnCollisionStay2D(Collision2D collision)
              {
                  isCollision = true;
                  //Debug.Log("isCollision : " + isCollision);
                  SetState(true);
              }
          
              private void OnCollisionExit2D(Collision2D collision)
              {
                 isCollision= false;
                  if (isFrozen)
                  {
                      return;
                  }
                  SetState(false);
              }
          
              public void SetFrozen(bool isFrozen)
              {
                  bool originValue = this.isFrozen;
                  if (!isCollision) return;
          
                  //Debug.Log("SetFrozen - originValue : " + originValue);
                  this.isFrozen = isFrozen;
                  //Debug.Log("SetFrozen - isFrozen : " + isFrozen);
                  //Debug.Log(isFrozen == originValue ? "ê°™ì€ íƒ€ì…" : this.isFrozen == true ? "ì–¼ë¦¼" : "ë…¹ì„");
              }
          
              private void SetState(bool isState)
              {
                  //if (isState == this.isState) return;
                  this.isState = isState;
                  //Debug.Log(this.isState == true ? "ì• ë‹ˆë©”ì´ì…˜ ì‘ë™" : "ì• ë‹ˆë©”ì´ì…˜ ë¯¸ì‘ë™");
              }
          }
      </details>

3. BaseController.cs (í”Œë ˆì´ì–´ ì´ë™)
      <details>
       <summary>[1. ê¸°ë³¸]</summary>
        
          if (UnityEngine.Input.GetKeyDown(downKey))
          {
              Debug.DrawRay(transform.position, Vector2.down * 2f, Color.green, 0.5f); //ì²´í¬
              RaycastHit2D hit = Physics2D.Raycast(transform.position, Vector2.down, 1f, LayerMask.GetMask("Interaction"));
              //Debug.Log("Trigger ê°ì§€ ì„¤ì •: " + Physics2D.queriesHitTriggers);
  
              if (hit.collider != null)
              {
                  GameObject hitObj = hit.collider.gameObject;
                  //Debug.Log("ì¶©ëŒì²´ : " + hit.collider.name);
  
                  IAbility ability = GetComponent<IAbility>();
                  if(ability != null)
                  {
                      gameObject.GetComponent<IAbility>().Interact(hit.collider.gameObject);
                      //ability.Interact(hit.collider.gameObject);
                  }
                  else
                  {
                      Debug.LogWarning("Ability NU11");
                  }
              }
              else { Debug.LogWarning("Raycast NU11"); }
          }
      }
      </details>

< ì½”ë“œ ìš”ì•½ >
1. ì¥ì• ë¬¼ ì˜¤ë¸Œì íŠ¸ì— Tag ë¶€ì—¬
2. í”Œë ˆì´ì–´ì™€ ì¶©ëŒ íŒë³„(í‚¤ ì…ë ¥)
3. raycastë¡œ ì‹¤í–‰
* ë ˆì´ìºìŠ¤íŠ¸ -> ì í”„ ì‹œ ê°ì§€ ë°©ì§€ë¥¼ ìœ„í•´ ì¶©ëŒ ì²´í¬

#### ğŸˆ ìƒˆë¡œ ì•Œê²Œ ëœ ê²ƒ
raydraw : 
raycast : 

#### ğŸˆ ë‹¤ì‹œ ê³µë¶€í•œ ê²ƒ
1. colliection : 
  1. dictionary : 
    1. Action : 
  2. list : 
2. rigidbody : 
  1. addforce : 

#### ğŸˆ ì‘ì„± ì‹œ ìœ ì˜í•´ì•¼ í•  ê²ƒ
1. í•œê°€ì§€ í–‰ë™ì€ í•œê³³ì—ì„œ
   ex) ì˜¤ë¸Œì íŠ¸ ì¶©ëŒ í›„ í‚¤ ì…ë ¥ì„ í†µí•´ ì‹¤í–‰ë˜ì–´ì•¼ í•´ì„œ, ì˜¤ë¸Œì íŠ¸ íŒë³„í•˜ëŠ” ë¶€ë¶„ì— í‚¤ ì…ë ¥ì„ ë°›ì•˜ì—ˆë‹¤.   
   í‚¤ ì…ë ¥ì€ í”Œë ˆì´ì–´ ì´ë™ ë¶€ë¶„ê³¼ ê´€ë ¨ ìˆìœ¼ë¯€ë¡œ í”Œë ˆì´ì–´ ìŠ¤í¬ë¦½íŠ¸ë¡œ ë„˜ì–´ê°!
